## Connecticut voter processing

Number of records: 2,369,712

See documentation and code sheets for more info 

--CREATE TABLE  
CREATE TABLE "CT_VOTERS" (  
"TOWN_ID"  TEXT,
"VTR_ID_VOTER"  TEXT,
"VTR_NM_LAST"  TEXT,
"VTR_NM_FIRST"  TEXT,
"VTR_NM_MID"  TEXT,
"VTR_NM_PREFIX"  TEXT,
"VTR_NM_SUFF"  TEXT,
"VTR_CD_STATUS"  TEXT,
"CD_SPEC_STATUS"  TEXT,
"CD_OFF_REASON"  TEXT,
"VTR_DIST"  TEXT,
"VTR_PREC"  TEXT,
"CONGRESS"  TEXT,
"SENATE"  TEXT,
"ASSEMBLY"  TEXT,
"POLL_PL_NAME"  TEXT,
"LOC_VTR_DIST"  TEXT,
"LOC_VTR_PREC"  TEXT,
"SPC_VTR_DIST"  TEXT,
"SPC_VTR_PREC"  TEXT,
"VTR_AD_NUM"  TEXT,
"VTR_AD_UNIT"  TEXT,
"NM_STREET"  TEXT,
"TOWN_NAME"  TEXT,
"ST"  TEXT,
"ZIP5"  TEXT,
"ZIP4"  TEXT,
"CARRIER"  TEXT,
"MAIL_NUM"  TEXT,
"MAIL_UNIT"  TEXT,
"MAIL_STR1"  TEXT,
"MAIL_STR2"  TEXT,
"MAIL_CITY"  TEXT,
"MAIL_ST"  TEXT,
"MAIL_COUNTRY"  TEXT,
"MAIL_ZIP"  TEXT,
"MAIL_CARRIER"  TEXT,
"DT_BIRTH"  TEXT,
"PHONE"  TEXT,
"CD_PARTY"  TEXT,
"CD_PARTY_UNQUAL"  TEXT,
"CD_SEX"  TEXT,
"DT_ACCEPT"  TEXT,
"ELECT_DT1"  TEXT,
"ELECT_TYPE1"  TEXT,
"ELECT_ABSTEE1"  TEXT,
"ELECT_DT2"  TEXT,
"ELECT_TYPE2"  TEXT,
"ELECT_ABSTEE2"  TEXT,
"ELECT_DT3"  TEXT,
"ELECT_TYPE3"  TEXT,
"ELECT_ABSTEE3"  TEXT,
"ELECT_DT4"  TEXT,
"ELECT_TYPE4"  TEXT,
"ELECT_ABSTEE4"  TEXT,
"ELECT_DT5"  TEXT,
"ELECT_TYPE5"  TEXT,
"ELECT_ABSTEE5"  TEXT,
"ELECT_DT6"  TEXT,
"ELECT_TYPE6"  TEXT,
"ELECT_ABSTEE6"  TEXT,
"ELECT_DT7"  TEXT,
"ELECT_TYPE7"  TEXT,
"ELECT_ABSTEE7"  TEXT,
"ELECT_DT8"  TEXT,
"ELECT_TYPE8"  TEXT,
"ELECT_ABSTEE8"  TEXT,
"ELECT_DT9"  TEXT,
"ELECT_TYPE9"  TEXT,
"ELECT_ABSTEE9"  TEXT,
"ELECT_DT10"  TEXT,
"ELECT_TYPE10"  TEXT,
"ELECT_ABSTEE10"  TEXT,
"ELECT_DT11"  TEXT,
"ELECT_TYPE11"  TEXT,
"ELECT_ABSTEE11"  TEXT,
"ELECT_DT12"  TEXT,
"ELECT_TYPE12"  TEXT,
"ELECT_ABSTEE12"  TEXT,
"ELECT_DT13"  TEXT,
"ELECT_TYPE13"  TEXT,
"ELECT_ABSTEE13"  TEXT,
"ELECT_DT14"  TEXT,
"ELECT_TYPE14"  TEXT,
"ELECT_ABSTEE14"  TEXT,
"ELECT_DT15"  TEXT,
"ELECT_TYPE15"  TEXT,
"ELECT_ABSTEE15"  TEXT,
"ELECT_DT16"  TEXT,
"ELECT_TYPE16"  TEXT,
"ELECT_ABSTEE16"  TEXT,
"ELECT_DT17"  TEXT,
"ELECT_TYPE17"  TEXT,
"ELECT_ABSTEE17"  TEXT,
"ELECT_DT18"  TEXT,
"ELECT_TYPE18"  TEXT,
"ELECT_ABSTEE18"  TEXT,
"ELECT_DT19"  TEXT,
"ELECT_TYPE19"  TEXT,
"ELECT_ABSTEE19"  TEXT,
"ELECT_DT20"  TEXT,
"ELECT_TYPE20"  TEXT,
"ELECT_ABSTEE20"  TEXT,
"ELECTFILL" TEXT)


--CREATE CITY LOOKUP TABLE TO FIX CITIES  
CREATE TABLE CITY_LOOKUP AS  
SELECT TOWN_NAME, UPPER(TOWN_NAME) AS CITY_CLEAN, COUNT(*)  
FROM CT_VOTERS  
GROUP BY 1  
ORDER BY 1  

--ADD NEW COLUMNS
ALTER TABLE CT_VOTERS ADD COLUMN YEAR;
ALTER TABLE CT_VOTERS ADD COLUMN BIRTHYEAR;
ALTER TABLE CT_VOTERS ADD COLUMN CITY_CLEAN;
--UPDATE NEW COLUMNS
UPDATE CT_VOTERS SET YEAR=SUBSTR(DT_ACCEPT,7,4);
UPDATE CT_VOTERS SET BIRTHYEAR=SUBSTR(DT_BIRTH,7,4);
UPDATE CT_VOTERS set CITY_CLEAN = (select y.CITY_CLEAN from city_lookup as y where y.TOWN_NAME=CT_VOTERS.TOWN_NAME)

--EXPORT   
CREATE TABLE CT_VOTERS_OUT AS  
select   
TOWN_ID, VTR_ID_VOTER, VTR_NM_LAST, VTR_NM_FIRST, VTR_NM_MID, VTR_NM_PREFIX, VTR_NM_SUFF, VTR_CD_STATUS, CD_SPEC_STATUS, CD_OFF_REASON, VTR_DIST, VTR_PREC, CONGRESS, SENATE, ASSEMBLY, POLL_PL_NAME, LOC_VTR_DIST, LOC_VTR_PREC, SPC_VTR_DIST, SPC_VTR_PREC, VTR_AD_NUM, VTR_AD_UNIT, NM_STREET, TOWN_NAME, ST, ZIP5, ZIP4, CARRIER, MAIL_NUM, MAIL_UNIT, MAIL_STR1, MAIL_STR2, MAIL_CITY, MAIL_ST, MAIL_COUNTRY, MAIL_ZIP, MAIL_CARRIER, DT_BIRTH, PHONE, CD_PARTY, CD_PARTY_UNQUAL, CD_SEX, DT_ACCEPT, ELECT_DT1, ELECT_TYPE1, ELECT_ABSTEE1, ELECT_DT2, ELECT_TYPE2, ELECT_ABSTEE2, ELECT_DT3, ELECT_TYPE3, ELECT_ABSTEE3, ELECT_DT4, ELECT_TYPE4, ELECT_ABSTEE4, ELECT_DT5, ELECT_TYPE5, ELECT_ABSTEE5, ELECT_DT6, ELECT_TYPE6, ELECT_ABSTEE6, ELECT_DT7, ELECT_TYPE7, ELECT_ABSTEE7, ELECT_DT8, ELECT_TYPE8, ELECT_ABSTEE8, ELECT_DT9, ELECT_TYPE9, ELECT_ABSTEE9, ELECT_DT10, ELECT_TYPE10, ELECT_ABSTEE10, ELECT_DT11, ELECT_TYPE11, ELECT_ABSTEE11, ELECT_DT12, ELECT_TYPE12, ELECT_ABSTEE12, ELECT_DT13, ELECT_TYPE13, ELECT_ABSTEE13, ELECT_DT14, ELECT_TYPE14, ELECT_ABSTEE14, ELECT_DT15, ELECT_TYPE15, ELECT_ABSTEE15, ELECT_DT16, ELECT_TYPE16, ELECT_ABSTEE16, ELECT_DT17, ELECT_TYPE17, ELECT_ABSTEE17, ELECT_DT18, ELECT_TYPE18, ELECT_ABSTEE18, ELECT_DT19, ELECT_TYPE19, ELECT_ABSTEE19, ELECT_DT20, ELECT_TYPE20, ELECT_ABSTEE20, BIRTHYEAR, YEAR, CITY_CLEAN  
FROM CT_VOTERS

**Known issues:**  
Several missing and bad ZIP5  
142,800 YEAR = 1800  
Dates of birth missing and out of range  
