## Idaho voter registration processing

Number of records:868,870 


--CREATE TABLE (No header in table, see record layout)  
CREATE TABLE "ID_VOTERS" ( 
"VOTERID"        	TEXT,
"LASTNAME"        	TEXT,
"FIRSTNAME"        	TEXT,
"MIDDLENAME"        	TEXT,
"SUFFIX"        	TEXT,
"STREETNUMBER"        	TEXT,
"STREETNAME"        	TEXT,
"UNIT"        		TEXT,
"STREETNAME2"        	TEXT,
"STREETNAME3"        	TEXT,
"CITY"        		TEXT,
"STATE"        		TEXT,
"ZIPCODE"        	TEXT,
"ZIP4CODE"        	TEXT,
"MAILSTREETNUMBER" 	TEXT,
"MAILSTREETNAME1"  	TEXT,
"MAILUNIT"        	TEXT,
"MAILSTREETNAME2"  	TEXT,
"MAILSTREETNAME3"  	TEXT,
"MAILCITY"        	TEXT,
"MAILSTATE"        	TEXT,
"MAILZIP"      		TEXT,
"MAILZIP4"     		TEXT,
"MAILCOUNTRY"       	TEXT,
"GENDER"        	TEXT,
"AGE"        		TEXT,
"REGDATE"     		TEXT,
"PHONE"      		TEXT,
"COUNTYNAME"        	TEXT,
"COUNTYPRECINCT"       	TEXT,
"STATELEGDISTRICT"      TEXT,
"CONGRDISTRICT"        	TEXT,
"PARTY"        		TEXT,
"ELECTIONDATE1"        	TEXT,
"ELECTIONNAME1"        	TEXT,
"VOTED1"        	TEXT,
"PARTYVOTED1"        	TEXT,
"BALLOTTYPE1"        	TEXT,
"ELECTIONDATE2"        	TEXT,
"ELECTIONNAME2"        	TEXT,
"VOTED2"        	TEXT,
"PARTYVOTED2"        	TEXT,
"BALLOTTYPE2"        	TEXT,
"ELECTIONDATE3"        	TEXT,
"ELECTIONNAME3"        	TEXT,
"VOTED3"        	TEXT,
"PARTYVOTED3"        	TEXT,
"BALLOTTYPE3"        	TEXT,
"ELECTIONDATE4"        	TEXT,
"ELECTIONNAME4"        	TEXT,
"VOTED4"        	TEXT,
"PARTYVOTED4"        	TEXT,
"BALLOTTYPE4"        	TEXT,
"ELECTIONDATE5"        	TEXT,
"ELECTIONNAME5"        	TEXT,
"VOTED5"        	TEXT,
"PARTYVOTED5"        	TEXT,
"BALLOTTYPE5"        	TEXT,
"ELECTIONDATE6"        	TEXT,
"ELECTIONNAME6"        	TEXT,
"VOTED6"        	TEXT,
"PARTYVOTED6"        	TEXT,
"BALLOTTYPE6"        	TEXT,
"ELECTIONDATE7"        	TEXT,
"ELECTIONNAME7"        	TEXT,
"VOTED7"        	TEXT,
"PARTYVOTED7"        	TEXT,
"BALLOTTYPE7"        	TEXT,
"ELECTIONDATE8"        	TEXT,
"ELECTIONNAME8"        	TEXT,
"VOTED8"        	TEXT,
"PARTYVOTED9"        	TEXT,
"BALLOTTYPE9"        	TEXT,
"ELECTIONDATE9"        	TEXT)  

--CREATE LOOKUP TABLE TO FIX CITY  
CREATE TABLE CITY_LOOKUP AS   
SELECT CITY, UPPER(CITY) AS CITY_CLEAN, COUNT(*)  
FROM ID_VOTERS  
GROUP BY 1  
ORDER BY 1  

--ADD NEW COLUMNS  
ALTER TABLE ID_VOTERS ADD COLUMN YEAR;  
ALTER TABLE ID_VOTERS ADD COLUMN CITY_CLEAN;  

--UPDATE COLUMNS  
UPDATE ID_VOTERS SET YEAR=SUBSTR(REGDATE,7,4);  
UPDATE ID_VOTERS set CITY_CLEAN = (select y.CITY_CLEAN from city_lookup as y where y.CITY=ID_VOTERS.CITY)  

--EXPORT TABLE  
CREATE TABLE ID_VOTERS_OUT AS  
SELECT  
VOTERID, LASTNAME, FIRSTNAME, MIDDLENAME, SUFFIX, STREETNUMBER, STREETNAME, UNIT, STREETNAME2, STREETNAME3, CITY, STATE, ZIPCODE, ZIP4CODE, MAILSTREETNUMBER,
MAILSTREETNAME1, MAILUNIT, MAILSTREETNAME2, MAILSTREETNAME3, MAILCITY, MAILSTATE, MAILZIP, MAILZIP4, MAILCOUNTRY, GENDER, AGE, REGDATE, PHONE, COUNTYNAME, COUNTYPRECINCT,
STATELEGDISTRICT, CONGRDISTRICT, PARTY, ELECTIONDATE1, ELECTIONNAME1, VOTED1, PARTYVOTED1, BALLOTTYPE1, ELECTIONDATE2, ELECTIONNAME2, VOTED2, PARTYVOTED2, BALLOTTYPE2, ELECTIONDATE3, ELECTIONNAME3, VOTED3, PARTYVOTED3, BALLOTTYPE3, ELECTIONDATE4, ELECTIONNAME4, VOTED4, PARTYVOTED4, BALLOTTYPE4, ELECTIONDATE5, ELECTIONNAME5, VOTED5, 
PARTYVOTED5, BALLOTTYPE5, ELECTIONDATE6, ELECTIONNAME6, VOTED6, PARTYVOTED6, BALLOTTYPE6, ELECTIONDATE7, ELECTIONNAME7, VOTED7, PARTYVOTED7, BALLOTTYPE7, ELECTIONDATE8, ELECTIONNAME8, VOTED8, CITY_CLEAN, YEAR FROM ID_VOTERS
